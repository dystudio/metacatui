<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>MetacatUI Dev Docs: Source: src/js/views/bookkeeper/OrdersView.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="styles/style.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: src/js/views/bookkeeper/OrdersView.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>define(["jquery",
    "underscore",
    "backbone",
    "collections/bookkeeper/Orders",
    "views/bookkeeper/OrderView"],
    function($, _, Backbone, Orders, OrderView){

    /**
    * @class OrdersView
    * @classdesc A view of the DataONE Services Orders that the logged-in User
    * has access to.
    * @extends Backbone.View
    * @
    */
    var OrdersView = Backbone.View.extend(
      /** @lends OrdersView.prototype */ {

      className: "orders-view",

      tagName: "div",

      /**
      * A reference to the Orders collection that is displayed in this view
      * @type {Orders}
      */
      orders: null,

      noOrdersTemplate: _.template('&lt;h3>Join ' + MetacatUI.appModel.get("dataonePlusName") + '&lt;/h3>'),

      render: function(){

        try{

          //If no Orders collection is set on this view and there is no dataone Orders
          // collection set on the UserModel, then wait for it to be fetched.
          if( !this.orders &amp;&amp; !MetacatUI.appUserModel.get("dataoneOrders") ){
            this.listenToOnce(MetacatUI.appUserModel, "change:dataoneOrders", function(dataoneOrders){
              this.orders = dataoneOrders;
              this.render();
            });
            return;
          }
          else if( this.orders.length == 0 ) {
            this.renderNoOrders();
            return;
          }

          //If the orders set on this view is not a Orders collection, then exit
          if( this.orders.type != "Orders" ){
            return;
          }

          var totalOrders = this.orders.length;

          //Create and render a OrderView for each Order
          this.orders.each(function(order){

            //Create and render this OrderView
            var orderView = new OrderView();
            orderView.order = order;
            this.$el.append( orderView.el );
            orderView.render();

            if( totalOrders > 1  &amp;&amp; order.getTotalQuotaLimit("portal") > 0 ){
              this.$el.append("&lt;hr/>");
            }

          }, this);

        }
        catch(e){
          console.error("Couldn't render the DataONE Orders: ", e);

          //TODO: Improve this error display
          this.$el.html("There was an issue displaying your DataONE Membership.");
        }

      },

      /**
      * If the User has no DataONE Order, then display the ability to create one.
      */
      renderNoOrders: function(){

        this.$el.html(this.noOrdersTemplate());

        var thisView = this;

        //Create a CreateOrderView and render it
        require(["views/bookkeeper/CreateOrderView"], function(CreateOrderView){
          createOrderView = new CreateOrderView();
          thisView.$el.append(createOrderView.el);
          createOrderView.render();
        });
      }

    });

    return OrdersView;

});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="AppConfig.html">AppConfig</a></li><li><a href="MetacatUI.html">MetacatUI</a></li></ul><h3>Classes</h3><ul><li><a href="AccessPolicy.html">AccessPolicy</a></li><li><a href="AccessPolicyView.html">AccessPolicyView</a></li><li><a href="AccessRule.html">AccessRule</a></li><li><a href="AppModel.html">AppModel</a></li><li><a href="AppView.html">AppView</a></li><li><a href="BooleanFilter.html">BooleanFilter</a></li><li><a href="ChoiceFilter.html">ChoiceFilter</a></li><li><a href="Citations.html">Citations</a></li><li><a href="CollectionModel.html">CollectionModel</a></li><li><a href="ColorPaletteView.html">ColorPaletteView</a></li><li><a href="CreateOrderView.html">CreateOrderView</a></li><li><a href="Customer.html">Customer</a></li><li><a href="DataCatalogView_drawTiles-TextOverlay.html">TextOverlay</a></li><li><a href="DataCatalogViewWithFilters.html">DataCatalogViewWithFilters</a></li><li><a href="DataItemView.html">DataItemView</a></li><li><a href="DataONEObject.html">DataONEObject</a></li><li><a href="DataPackage.html">DataPackage</a></li><li><a href="DateFilter.html">DateFilter</a></li><li><a href="DraftsView.html">DraftsView</a></li><li><a href="EditCollectionView.html">EditCollectionView</a></li><li><a href="EditorView.html">EditorView</a></li><li><a href="EML211.html">EML211</a></li><li><a href="EML211EditorView.html">EML211EditorView</a></li><li><a href="EMLEntity.html">EMLEntity</a></li><li><a href="EMLEntityView.html">EMLEntityView</a></li><li><a href="EMLGeoCoverage.html">EMLGeoCoverage</a></li><li><a href="EMlGeoCoverageView.html">EMlGeoCoverageView</a></li><li><a href="EMLNonNumericDomain.html">EMLNonNumericDomain</a></li><li><a href="EMLNumericDomain.html">EMLNumericDomain</a></li><li><a href="EMLPartyView.html">EMLPartyView</a></li><li><a href="EMLTemporalCoverage.html">EMLTemporalCoverage</a></li><li><a href="EMLView.html">EMLView</a></li><li><a href="Filter.html">Filter</a></li><li><a href="FilterGroup.html">FilterGroup</a></li><li><a href="FilterGroupsView.html">FilterGroupsView</a></li><li><a href="Filters.html">Filters</a></li><li><a href="GroupListView.html">GroupListView</a></li><li><a href="ImageUploaderView.html">ImageUploaderView</a></li><li><a href="LookupModel.html">LookupModel</a></li><li><a href="MarkdownEditorView.html">MarkdownEditorView</a></li><li><a href="MarkdownView.html">MarkdownView</a></li><li><a href="MetadataView.html">MetadataView</a></li><li><a href="MetricModalView.html">MetricModalView</a></li><li><a href="NavbarView.html">NavbarView</a></li><li><a href="NumericFilter.html">NumericFilter</a></li><li><a href="ObjectFormats.html">ObjectFormats</a></li><li><a href="Order.html">Order</a></li><li><a href="Orders.html">Orders</a></li><li><a href="OrdersView.html">OrdersView</a></li><li><a href="OrderView.html">OrderView</a></li><li><a href="PortalDataView.html">PortalDataView</a></li><li><a href="PortalEditorView.html">PortalEditorView</a></li><li><a href="PortalListView.html">PortalListView</a></li><li><a href="PortalLogosView.html">PortalLogosView</a></li><li><a href="PortalMembersView.html">PortalMembersView</a></li><li><a href="PortalModel.html">PortalModel</a></li><li><a href="PortalSectionView.html">PortalSectionView</a></li><li><a href="PortalUsagesView.html">PortalUsagesView</a></li><li><a href="PortalView.html">PortalView</a></li><li><a href="PortEditorDataView.html">PortEditorDataView</a></li><li><a href="PortEditorImageView.html">PortEditorImageView</a></li><li><a href="PortEditorLogosView.html">PortEditorLogosView</a></li><li><a href="PortEditorMdSectionView.html">PortEditorMdSectionView</a></li><li><a href="PortEditorSectionsView.html">PortEditorSectionsView</a></li><li><a href="PortEditorSectionView.html">PortEditorSectionView</a></li><li><a href="PortEditorSettingsView.html">PortEditorSettingsView</a></li><li><a href="Product.html">Product</a></li><li><a href="Products.html">Products</a></li><li><a href="QualityReport.html">QualityReport</a></li><li><a href="Quota.html">Quota</a></li><li><a href="Quotas.html">Quotas</a></li><li><a href="RegisterCitationView.html">RegisterCitationView</a></li><li><a href="Search.html">Search</a></li><li><a href="SolrResultList.html">SolrResultList</a></li><li><a href="SpatialFilter.html">SpatialFilter</a></li><li><a href="Stats.html">Stats</a></li><li><a href="TableEditorView.html">TableEditorView</a></li><li><a href="ToggleFilter.html">ToggleFilter</a></li><li><a href="UIRouter.html">UIRouter</a></li><li><a href="Usage.html">Usage</a></li><li><a href="Usages.html">Usages</a></li><li><a href="User.html">User</a></li><li><a href="UserSettingsView.html">UserSettingsView</a></li><li><a href="UserView.html">UserView</a></li></ul><h3>Global</h3><ul><li><a href="global.html#appConfigPath">appConfigPath</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Tue Oct 20 2020 22:49:21 GMT-0500 (Central Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
